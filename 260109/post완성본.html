<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <style>
            body {
                margin: 0 auto;
                padding: 0;
            }
            .user-container {
                width: 80%;
                background-color: grey;
            }

            .user-container > h3 {
                background-color: aqua;
            }
            .user-container > p {
                border: 1px solid black;
            }
        </style>
    </head>
    <body>

        <div id="user-container" class="user-container">
            <h3>[userid]title</h3>
            <p>body</p>
        </div>
    </body>
    <script>
        const xhttp = new XMLHttpRequest();
        xhttp.open("GET", "https://jsonplaceholder.typicode.com/posts", true);
        xhttp.send();
        /*
    xhttp.onreadystatechange=function(){
        //console.log(xhttp.responseText);
        //document.write(xhttp.responseText);
        //responseText는 문자열
        //문자열을 객체로 변경
        //const obj=JSON.parse(xhttp.responseText); //중간에 오류 발생
        //document.write(obj);
        //document.write(obj[0]);
        //document.write(obj[0]["id"]);
        console.log(xhttp);
        console.log(xhttp.responseXML);
    }
    */

        xhttp.onload = function () {
            console.log(xhttp);
            //console.log(xhttp.response); console.log(xhttp.responseText);
            const obj = JSON.parse(xhttp.responseText); //문자열 -> 객체 변환
            console.log(obj);
            console.log(typeof obj); //배열{}도 object이고 객체{}도 object
            console.log(Array.isArray(obj)); //객체중에서도 배열입니까?
            console.log(typeof obj[0]);
            console.log(Array.isArray(obj[0]));
            console.log(obj[0] instanceof Object);
            //Object접근방법(첫번째)
            console.log(obj[0]["id"]);
            console.log(obj[0]["userId"]);
            console.log(obj[0]["title"]);
            console.log(obj[0]["body"]);
            //Object접근방법(두번째)
            console.log(obj[0].id);
            console.log(obj[0].userId);
            console.log(obj[0].title);
            console.log(obj[0].body);
            //html화면에 표시하기 위해서는 폼을 작성(필요없는 정보는 제거)
            /*
    const header=document.querySelector("#user-container>h3");
    const body=document.querySelector("#user-container>p");
    let _userId=obj[0].userId;
    let _title=obj[0].title;
    let _body=obj[0].body;
    header.textContent=`[${_userId}]${_title}`;
    body.textContent=`${_body}`;
    */
            // 위의 코드를 이용하여 모든 객체를 화면에 표시하시오 body객체를 얻은 후 아래의 객체를 create하고 append처리하여 모든 데이터를
            // 표시하시오.

            for (i = 0; i < obj.length; i++) {
                //1)h3태그를 생성(수신값 textContent처리)
                const h3 = document.createElement("h3");
                h3.textContent = `[${obj[i]
                    .id}]${obj[i]
                    .title}`;
                //2)p태그를 생성(수신값 textContent처리)
                const p = document.createElement("p");
                p.textContent = `${obj[i].body}`;
                //3)div태그를 생성(id는 user-container1,2,3..., class user-container 속성추가)
                const div = document.createElement("div");
                div.id = `user-container${i}`;
                div.className = "user-container";
                //4)div에 h3, p태그를 append
                div.append(h3);
                div.append(p);
                //5)body객체를 얻은 후 div를 append
                document
                    .querySelector("body")
                    .append(div);
            }
        }
    </script>
</html>